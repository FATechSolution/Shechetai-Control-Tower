module.exports=[18622,(e,t,a)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,t,a)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},54799,(e,t,a)=>{t.exports=e.x("crypto",()=>require("crypto"))},59787,e=>{"use strict";var t=e.i(89171);class a extends Error{statusCode;code;constructor(e,t,a){super(t),this.statusCode=e,this.code=a,this.name="ApiError"}}function i(e,a){return t.NextResponse.json({success:!0,data:e,message:a})}function r(e,a=400){let i="string"==typeof e?e:e.message;return t.NextResponse.json({success:!1,error:i},{status:a})}function s(e){return(console.error("API Error:",e),e instanceof a)?r(e.message,e.statusCode):e instanceof Error?r(e.message,500):r("An unexpected error occurred",500)}function n(e){return{page:Math.max(1,parseInt(e.get("page")||"1",10)),limit:Math.min(100,Math.max(1,parseInt(e.get("limit")||"20",10)))}}function c(e,t,a,i){return{data:e,pagination:{page:a,limit:i,total:t,totalPages:Math.ceil(t/i)}}}async function l(e){try{let t=e.headers.get("content-type");if(!t||!t.includes("application/json"))return{};let a=await e.json();return"object"==typeof a?a:{}}catch(e){return console.error("Failed to parse JSON:",e),{}}}e.s(["createPaginatedResponse",()=>c,"errorResponse",()=>r,"handleApiError",()=>s,"parsePagination",()=>n,"safeParseJson",()=>l,"successResponse",()=>i])},12224,e=>e.a(async(t,a)=>{try{var i=e.i(707),r=t([i]);[i]=r.then?(await r)():r;class s{static db=(0,i.getFirebaseDb)();static async getAll(e){return(await this.db.collection(e).get()).docs.map(e=>({id:e.id,...e.data()}))}static async query(e,t){let a=this.db.collection(e);return t.forEach(e=>{a=a.where(e.field,e.op,e.value)}),(await a.get()).docs.map(e=>({id:e.id,...e.data()}))}static async getById(e,t){let a=await this.db.collection(e).doc(t).get();return a.exists?{id:a.id,...a.data()}:null}static async create(e,t){let a=Object.entries(t).reduce((e,[t,a])=>(void 0!==a&&(e[t]=a),e),{}),i=await this.db.collection(e).add({...a,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),r=await i.get();return{id:r.id,...r.data()}}static async createWithId(e,t,a){let i=Object.entries(a).reduce((e,[t,a])=>(void 0!==a&&(e[t]=a),e),{});await this.db.collection(e).doc(t).set({...i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});let r=await this.db.collection(e).doc(t).get();return{id:r.id,...r.data()}}static async update(e,t,a){let i=this.db.collection(e).doc(t);if(!(await i.get()).exists)return null;let r=Object.entries(a).reduce((e,[t,a])=>(void 0!==a&&(e[t]=a),e),{});await i.update({...r,updatedAt:new Date().toISOString()});let s=await i.get();return{id:s.id,...s.data()}}static async delete(e,t){try{return await this.db.collection(e).doc(t).delete(),!0}catch(e){return console.error(`Error deleting document ${t}:`,e),!1}}static async getPaginated(e,t,a,i){let r=this.db.collection(e);i&&i.forEach(e=>{r=r.where(e.field,e.op,e.value)});let s=(await r.get()).size;return{items:(await r.offset(a).limit(t).get()).docs.map(e=>({id:e.id,...e.data()})),total:s}}}class n{static collection="agents";static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async getByTeam(e){return s.query(this.collection,[{field:"teamId",op:"==",value:e}])}static async create(e){return s.create(this.collection,e)}static async update(e,t){return s.update(this.collection,e,t)}static async delete(e){return s.delete(this.collection,e)}static async getAnalytics(e){return{agentId:e,totalRequests:0,successfulRequests:0,failedRequests:0,averageResponseTime:0,usageByDay:[]}}}class c{static collection="teams";static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async getByOwner(e){return s.query(this.collection,[{field:"ownerId",op:"==",value:e}])}static async create(e){return s.create(this.collection,e)}static async update(e,t){return s.update(this.collection,e,t)}static async delete(e){return s.delete(this.collection,e)}static async getAnalytics(e){return{teamId:e,totalAgents:0,activeAgents:0,totalMembers:0,seatUtilization:0,totalRequests:0,monthlySpend:0,activityLog:[]}}}class l{static collection="users";static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async getByEmail(e){let t=await s.query(this.collection,[{field:"email",op:"==",value:e}]);return t.length>0?t[0]:null}static async getByTeam(e){return s.query(this.collection,[{field:"teamId",op:"==",value:e}])}static async create(e,t){return s.createWithId(this.collection,e,t)}static async update(e,t){return s.update(this.collection,e,t)}static async delete(e){return s.delete(this.collection,e)}}class o{static collection="contracts";static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async getByTeam(e){return s.query(this.collection,[{field:"teamId",op:"==",value:e}])}static async getByTeamId(e){return this.getByTeam(e)}static async create(e){return s.create(this.collection,e)}static async update(e,t){return s.update(this.collection,e,t)}}class d{static collection="wallets";static db=(0,i.getFirebaseDb)();static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async getByTeamId(e){return this.getById(e)}static async getByEntity(e,t){if("team"===t)return this.getByTeamId(e);let a=await s.query(this.collection,[{field:"entityId",op:"==",value:e},{field:"entityType",op:"==",value:t}]);return a.length>0?a[0]:null}static async create(e){let t=e.teamId;if(!t)throw Error("teamId is required to create a wallet");let a={...e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await this.db.collection(this.collection).doc(t).set(a);let i=await this.db.collection(this.collection).doc(t).get();return{id:i.id,walletId:i.id,...i.data()}}static async update(e,t){let a={...t,updatedAt:new Date().toISOString()};await this.db.collection(this.collection).doc(e).update(a);let i=await this.db.collection(this.collection).doc(e).get();return i.exists?{id:i.id,walletId:i.id,...i.data()}:null}static async updateBalance(e,t){let a=this.db.collection(this.collection).doc(e),i=await a.get();if(!i.exists)return null;let r=i.data()?.balance||0;await a.update({balance:r+t,updatedAt:new Date().toISOString()});let s=await a.get();return{id:s.id,walletId:s.id,...s.data()}}}class u{static collection="creditTransactions";static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async getByWallet(e){return s.query(this.collection,[{field:"walletId",op:"==",value:e}])}static async create(e){return s.create(this.collection,e)}}class p{static collection="subscriptionPlans";static async getAll(){return(await s.getAll(this.collection)).map(e=>({...e,planId:e.id}))}static async getActive(){return(await s.query(this.collection,[{field:"status",op:"==",value:"active"}])).map(e=>({...e,planId:e.id}))}static async getById(e){let t=await s.getById(this.collection,e);return t?{...t,planId:t.id}:null}static async create(e){let t=await s.create(this.collection,e);return{...t,planId:t.id}}static async update(e,t){let a=await s.update(this.collection,e,t);return a?{...a,planId:a.id}:null}}class y{static collection="subscriptions";static async getAll(){return(await s.getAll(this.collection)).map(e=>({...e,subscriptionId:e.id}))}static async getById(e){let t=await s.getById(this.collection,e);return t?{...t,subscriptionId:t.id}:null}static async getByUser(e){return(await s.query(this.collection,[{field:"userId",op:"==",value:e}])).map(e=>({...e,subscriptionId:e.id}))}static async getByTeamId(e){return(await s.query(this.collection,[{field:"teamId",op:"==",value:e}])).map(e=>({...e,subscriptionId:e.id}))}static async create(e){let t=await s.create(this.collection,e);return{...t,subscriptionId:t.id}}static async update(e,t){let a=await s.update(this.collection,e,t);return a?{...a,subscriptionId:a.id}:null}}class g{static collection="payment-methods";static async getByUser(e){return s.query(this.collection,[{field:"userId",op:"==",value:e}])}static async getById(e){return s.getById(this.collection,e)}static async create(e){return s.create(this.collection,e)}static async delete(e){return s.delete(this.collection,e)}static async setDefault(e){return s.update(this.collection,e,{isDefault:!0})}}class h{static collection="auditLogs";static async create(e){return s.create(this.collection,e)}static async getAll(e=100,t=0){return s.getPaginated(this.collection,e,t)}static async getByUser(e){return s.query(this.collection,[{field:"userId",op:"==",value:e}])}}class w{static collection="featureFlags";static async getAll(){return s.getAll(this.collection)}static async getById(e){return s.getById(this.collection,e)}static async create(e){return s.create(this.collection,e)}static async update(e,t){return s.update(this.collection,e,t)}static async delete(e){return s.delete(this.collection,e)}}class I{static collection="whiteLabelConfigs";static async getAll(){return(await s.getAll(this.collection)).map(e=>({...e,configId:e.id}))}static async getById(e){let t=await s.getById(this.collection,e);return t?{...t,configId:t.id}:null}static async getByTeamId(e){return(await s.query(this.collection,[{field:"teamId",op:"==",value:e}])).map(e=>({...e,configId:e.id}))}static async create(e){let t=await s.create(this.collection,e);return{...t,configId:t.id}}static async update(e,t){let a=await s.update(this.collection,e,t);return a?{...a,configId:a.id}:null}static async delete(e){return s.delete(this.collection,e)}}class m{static collection="referrals";static async getAll(){return(await s.getAll(this.collection)).map(e=>({...e,referralId:e.id}))}static async getById(e){let t=await s.getById(this.collection,e);return t?{...t,referralId:t.id}:null}static async getByReferrer(e){return(await s.query(this.collection,[{field:"referrerId",op:"==",value:e}])).map(e=>({...e,referralId:e.id}))}static async create(e){let t=await s.create(this.collection,e);return{...t,referralId:t.id}}static async update(e,t){let a=await s.update(this.collection,e,t);return a?{...a,referralId:a.id}:null}}class f{static collection="teamMembers";static async getAll(){return s.getAll(this.collection)}static async getByTeam(e){return s.query(this.collection,[{field:"teamId",op:"==",value:e}])}static async getById(e){return s.getById(this.collection,e)}static async create(e){return s.create(this.collection,e)}static async update(e,t){return s.update(this.collection,e,t)}static async delete(e){return s.delete(this.collection,e)}static async removeByUserAndTeam(e,t){let a=(0,i.getFirebaseDb)(),r=await a.collection(this.collection).where("teamId","==",e).where("userId","==",t).get();return!r.empty&&(await r.docs[0].ref.delete(),!0)}}class v{static collection="teamInvites";static async getAll(){return(await s.getAll(this.collection)).map(e=>({...e,inviteId:e.id}))}static async getByTeam(e){return(await s.query(this.collection,[{field:"teamId",op:"==",value:e}])).map(e=>({...e,inviteId:e.id}))}static async getByTeamId(e){return this.getByTeam(e)}static async getById(e){let t=await s.getById(this.collection,e);return t?{...t,inviteId:t.id}:null}static async create(e){let t=await s.create(this.collection,e);return{...t,inviteId:t.id}}static async update(e,t){return s.update(this.collection,e,t)}static async delete(e){return s.delete(this.collection,e)}}n.getAll,n.getById,n.create,n.update,n.delete,c.getAll,c.getById,c.create,c.update,c.delete,l.getAll,l.getById,l.create,l.update,l.delete,o.getAll,o.getById,o.create,o.update,d.getAll,d.getById,d.create,d.update,u.getAll,u.getById,u.create,I.getAll,I.getById,I.create,I.update,I.delete,m.getAll,m.getById,m.create,m.update,e.s(["AgentDatabase",()=>n,"AuditLogDatabase",()=>h,"ContractDatabase",()=>o,"FeatureFlagDatabase",()=>w,"PaymentMethodDatabase",()=>g,"PlanDatabase",()=>p,"ReferralDatabase",()=>m,"SubscriptionDatabase",()=>y,"TeamDatabase",()=>c,"TeamInviteDatabase",()=>v,"TeamMemberDatabase",()=>f,"TransactionDatabase",()=>u,"UserDatabase",()=>l,"WalletDatabase",()=>d,"WhiteLabelDatabase",()=>I]),a()}catch(e){a(e)}},!1),92464,e=>e.a(async(t,a)=>{try{var i=e.i(98003),r=e.i(59787),s=e.i(12224),n=t([i,s]);async function c(e){return(0,i.withAuth)(e,async e=>{try{let{searchParams:t}=new URL(e.url),{page:a,limit:i}=(0,r.parsePagination)(t),n={role:t.get("role")||void 0,status:t.get("status")||void 0,search:t.get("search")||void 0},c=await s.UserDatabase.getAll();if(n.role&&(c=c.filter(e=>e.role===n.role)),n.status&&(c=c.filter(e=>e.status===n.status)),n.search){let e=n.search.toLowerCase();c=c.filter(t=>t.userId.toLowerCase().includes(e)||t.email.toLowerCase().includes(e)||t.name.toLowerCase().includes(e))}let l=(a-1)*i,o=c.slice(l,l+i),d=(0,r.createPaginatedResponse)(o,c.length,a,i);return(0,r.successResponse)(d)}catch(e){return(0,r.handleApiError)(e)}},"super_admin")}async function l(e){return(0,i.withAuth)(e,async(e,t)=>{try{let a=await e.json();if(!a.email||!a.name)return(0,r.errorResponse)("Missing required fields: email, name",400);if(await s.UserDatabase.getByEmail(a.email))return(0,r.errorResponse)("User with this email already exists",400);let i=`user_${Date.now()}`,n=await s.UserDatabase.create(i,{email:a.email,name:a.name,role:a.role||"user",status:"active",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),lastLoginAt:new Date().toISOString()});return await s.AuditLogDatabase.create({userId:t.userId,userEmail:t.email,action:"user_created",resource:"user",resourceId:n.userId,details:{email:n.email,role:n.role}}),(0,r.successResponse)(n,"User created successfully")}catch(e){return(0,r.handleApiError)(e)}},"super_admin")}[i,s]=n.then?(await n)():n,e.s(["GET",()=>c,"POST",()=>l]),a()}catch(e){a(e)}},!1),72797,e=>e.a(async(t,a)=>{try{var i=e.i(47909),r=e.i(74017),s=e.i(96250),n=e.i(59756),c=e.i(61916),l=e.i(14444),o=e.i(10680),d=e.i(69741),u=e.i(16795),p=e.i(87718),y=e.i(95169),g=e.i(47587),h=e.i(66012),w=e.i(70101),I=e.i(26937),m=e.i(10372),f=e.i(93695);e.i(52474);var v=e.i(220),A=e.i(92464),b=t([A]);[A]=b.then?(await b)():b;let B=new i.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/users/route",pathname:"/api/users",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/users/route.ts",nextConfigOutput:"",userland:A}),{workAsyncStorage:E,workUnitAsyncStorage:D,serverHooks:S}=B;function R(){return(0,s.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:D})}async function x(e,t,a){B.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/users/route";i=i.replace(/\/index$/,"")||"/";let s=await B.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:A,params:b,nextConfig:R,parsedUrl:x,isDraftMode:E,prerenderManifest:D,routerServerContext:S,isOnDemandRevalidate:T,revalidateOnlyGenerated:C,resolvedPathname:q,clientReferenceManifest:O,serverActionsManifest:P}=s,U=(0,d.normalizeAppPath)(i),j=!!(D.dynamicRoutes[U]||D.routes[q]),N=async()=>((null==S?void 0:S.render404)?await S.render404(e,t,x,!1):t.end("This page could not be found"),null);if(j&&!E){let e=!!D.routes[q],t=D.dynamicRoutes[U];if(t&&!1===t.fallback&&!e){if(R.experimental.adapterPath)return await N();throw new f.NoFallbackError}}let M=null;!j||B.isDev||E||(M=q,M="/index"===M?"/":M);let _=!0===B.isDev||!j,k=j&&!_;P&&O&&(0,l.setReferenceManifestsSingleton)({page:i,clientReferenceManifest:O,serverActionsManifest:P,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:P})});let H=e.method||"GET",L=(0,c.getTracer)(),F=L.getActiveScopeSpan(),$={params:b,prerenderManifest:D,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:_,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,i)=>B.onRequestError(e,t,i,S)},sharedContext:{buildId:A}},K=new u.NodeNextRequest(e),W=new u.NodeNextResponse(t),G=p.NextRequestAdapter.fromNodeNextRequest(K,(0,p.signalFromNodeResponse)(t));try{let s=async e=>B.handle(G,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=L.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==y.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${H} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${i}`)}),l=!!(0,n.getRequestMeta)(e,"minimalMode"),o=async n=>{var c,o;let d=async({previousCacheEntry:r})=>{try{if(!l&&T&&C&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await s(n);e.fetchMetrics=$.renderOpts.fetchMetrics;let c=$.renderOpts.pendingWaitUntil;c&&a.waitUntil&&(a.waitUntil(c),c=void 0);let o=$.renderOpts.collectedTags;if(!j)return await (0,h.sendResponse)(K,W,i,$.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,w.toNodeOutgoingHttpHeaders)(i.headers);o&&(t[m.NEXT_CACHE_TAGS_HEADER]=o),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,r=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:v.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==r?void 0:r.isStale)&&await B.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,g.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:T})},S),t}},u=await B.handleResponse({req:e,nextConfig:R,cacheKey:M,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:D,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:C,responseGenerator:d,waitUntil:a.waitUntil,isMinimalMode:l});if(!j)return null;if((null==u||null==(c=u.value)?void 0:c.kind)!==v.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(o=u.value)?void 0:o.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",T?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),E&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,w.fromNodeOutgoingHttpHeaders)(u.value.headers);return l&&j||p.delete(m.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,I.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(K,W,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};F?await o(F):await L.withPropagatedContext(e.headers,()=>L.trace(y.BaseServerSpan.handleRequest,{spanName:`${H} ${i}`,kind:c.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},o))}catch(t){if(t instanceof f.NoFallbackError||await B.onRequestError(e,t,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,g.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:T})}),j)throw t;return await (0,h.sendResponse)(K,W,new Response(null,{status:500})),null}}e.s(["handler",()=>x,"patchFetch",()=>R,"routeModule",()=>B,"serverHooks",()=>S,"workAsyncStorage",()=>E,"workUnitAsyncStorage",()=>D]),a()}catch(e){a(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__d1a810bd._.js.map