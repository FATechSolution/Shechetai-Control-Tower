module.exports=[18622,(t,e,a)=>{e.exports=t.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(t,e,a)=>{e.exports=t.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(t,e,a)=>{e.exports=t.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(t,e,a)=>{e.exports=t.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(t,e,a)=>{e.exports=t.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},54799,(t,e,a)=>{e.exports=t.x("crypto",()=>require("crypto"))},59787,t=>{"use strict";var e=t.i(89171);class a extends Error{statusCode;code;constructor(t,e,a){super(e),this.statusCode=t,this.code=a,this.name="ApiError"}}function i(t,a){return e.NextResponse.json({success:!0,data:t,message:a})}function r(t,a=400){let i="string"==typeof t?t:t.message;return e.NextResponse.json({success:!1,error:i},{status:a})}function n(t){return(console.error("API Error:",t),t instanceof a)?r(t.message,t.statusCode):t instanceof Error?r(t.message,500):r("An unexpected error occurred",500)}function s(t){return{page:Math.max(1,parseInt(t.get("page")||"1",10)),limit:Math.min(100,Math.max(1,parseInt(t.get("limit")||"20",10)))}}function c(t,e,a,i){return{data:t,pagination:{page:a,limit:i,total:e,totalPages:Math.ceil(e/i)}}}async function l(t){try{let e=t.headers.get("content-type");if(!e||!e.includes("application/json"))return{};let a=await t.json();return"object"==typeof a?a:{}}catch(t){return console.error("Failed to parse JSON:",t),{}}}t.s(["createPaginatedResponse",()=>c,"errorResponse",()=>r,"handleApiError",()=>n,"parsePagination",()=>s,"safeParseJson",()=>l,"successResponse",()=>i])},12224,t=>t.a(async(e,a)=>{try{var i=t.i(707),r=e([i]);[i]=r.then?(await r)():r;class n{static db=(0,i.getFirebaseDb)();static async getAll(t){return(await this.db.collection(t).get()).docs.map(t=>({id:t.id,...t.data()}))}static async query(t,e){let a=this.db.collection(t);return e.forEach(t=>{a=a.where(t.field,t.op,t.value)}),(await a.get()).docs.map(t=>({id:t.id,...t.data()}))}static async getById(t,e){let a=await this.db.collection(t).doc(e).get();return a.exists?{id:a.id,...a.data()}:null}static async create(t,e){let a=Object.entries(e).reduce((t,[e,a])=>(void 0!==a&&(t[e]=a),t),{}),i=await this.db.collection(t).add({...a,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),r=await i.get();return{id:r.id,...r.data()}}static async createWithId(t,e,a){let i=Object.entries(a).reduce((t,[e,a])=>(void 0!==a&&(t[e]=a),t),{});await this.db.collection(t).doc(e).set({...i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});let r=await this.db.collection(t).doc(e).get();return{id:r.id,...r.data()}}static async update(t,e,a){let i=this.db.collection(t).doc(e);if(!(await i.get()).exists)return null;let r=Object.entries(a).reduce((t,[e,a])=>(void 0!==a&&(t[e]=a),t),{});await i.update({...r,updatedAt:new Date().toISOString()});let n=await i.get();return{id:n.id,...n.data()}}static async delete(t,e){try{return await this.db.collection(t).doc(e).delete(),!0}catch(t){return console.error(`Error deleting document ${e}:`,t),!1}}static async getPaginated(t,e,a,i){let r=this.db.collection(t);i&&i.forEach(t=>{r=r.where(t.field,t.op,t.value)});let n=(await r.get()).size;return{items:(await r.offset(a).limit(e).get()).docs.map(t=>({id:t.id,...t.data()})),total:n}}}class s{static collection="agents";static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async getByTeam(t){return n.query(this.collection,[{field:"teamId",op:"==",value:t}])}static async create(t){return n.create(this.collection,t)}static async update(t,e){return n.update(this.collection,t,e)}static async delete(t){return n.delete(this.collection,t)}static async getAnalytics(t){return{agentId:t,totalRequests:0,successfulRequests:0,failedRequests:0,averageResponseTime:0,usageByDay:[]}}}class c{static collection="teams";static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async getByOwner(t){return n.query(this.collection,[{field:"ownerId",op:"==",value:t}])}static async create(t){return n.create(this.collection,t)}static async update(t,e){return n.update(this.collection,t,e)}static async delete(t){return n.delete(this.collection,t)}static async getAnalytics(t){return{teamId:t,totalAgents:0,activeAgents:0,totalMembers:0,seatUtilization:0,totalRequests:0,monthlySpend:0,activityLog:[]}}}class l{static collection="users";static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async getByEmail(t){let e=await n.query(this.collection,[{field:"email",op:"==",value:t}]);return e.length>0?e[0]:null}static async getByTeam(t){return n.query(this.collection,[{field:"teamId",op:"==",value:t}])}static async create(t,e){return n.createWithId(this.collection,t,e)}static async update(t,e){return n.update(this.collection,t,e)}static async delete(t){return n.delete(this.collection,t)}}class o{static collection="contracts";static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async getByTeam(t){return n.query(this.collection,[{field:"teamId",op:"==",value:t}])}static async getByTeamId(t){return this.getByTeam(t)}static async create(t){return n.create(this.collection,t)}static async update(t,e){return n.update(this.collection,t,e)}}class d{static collection="wallets";static db=(0,i.getFirebaseDb)();static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async getByTeamId(t){return this.getById(t)}static async getByEntity(t,e){if("team"===e)return this.getByTeamId(t);let a=await n.query(this.collection,[{field:"entityId",op:"==",value:t},{field:"entityType",op:"==",value:e}]);return a.length>0?a[0]:null}static async create(t){let e=t.teamId;if(!e)throw Error("teamId is required to create a wallet");let a={...t,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await this.db.collection(this.collection).doc(e).set(a);let i=await this.db.collection(this.collection).doc(e).get();return{id:i.id,walletId:i.id,...i.data()}}static async update(t,e){let a={...e,updatedAt:new Date().toISOString()};await this.db.collection(this.collection).doc(t).update(a);let i=await this.db.collection(this.collection).doc(t).get();return i.exists?{id:i.id,walletId:i.id,...i.data()}:null}static async updateBalance(t,e){let a=this.db.collection(this.collection).doc(t),i=await a.get();if(!i.exists)return null;let r=i.data()?.balance||0;await a.update({balance:r+e,updatedAt:new Date().toISOString()});let n=await a.get();return{id:n.id,walletId:n.id,...n.data()}}}class u{static collection="creditTransactions";static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async getByWallet(t){return n.query(this.collection,[{field:"walletId",op:"==",value:t}])}static async create(t){return n.create(this.collection,t)}}class p{static collection="subscriptionPlans";static async getAll(){return(await n.getAll(this.collection)).map(t=>({...t,planId:t.id}))}static async getActive(){return(await n.query(this.collection,[{field:"status",op:"==",value:"active"}])).map(t=>({...t,planId:t.id}))}static async getById(t){let e=await n.getById(this.collection,t);return e?{...e,planId:e.id}:null}static async create(t){let e=await n.create(this.collection,t);return{...e,planId:e.id}}static async update(t,e){let a=await n.update(this.collection,t,e);return a?{...a,planId:a.id}:null}}class y{static collection="subscriptions";static async getAll(){return(await n.getAll(this.collection)).map(t=>({...t,subscriptionId:t.id}))}static async getById(t){let e=await n.getById(this.collection,t);return e?{...e,subscriptionId:e.id}:null}static async getByUser(t){return(await n.query(this.collection,[{field:"userId",op:"==",value:t}])).map(t=>({...t,subscriptionId:t.id}))}static async getByTeamId(t){return(await n.query(this.collection,[{field:"teamId",op:"==",value:t}])).map(t=>({...t,subscriptionId:t.id}))}static async create(t){let e=await n.create(this.collection,t);return{...e,subscriptionId:e.id}}static async update(t,e){let a=await n.update(this.collection,t,e);return a?{...a,subscriptionId:a.id}:null}}class g{static collection="payment-methods";static async getByUser(t){return n.query(this.collection,[{field:"userId",op:"==",value:t}])}static async getById(t){return n.getById(this.collection,t)}static async create(t){return n.create(this.collection,t)}static async delete(t){return n.delete(this.collection,t)}static async setDefault(t){return n.update(this.collection,t,{isDefault:!0})}}class h{static collection="auditLogs";static async create(t){return n.create(this.collection,t)}static async getAll(t=100,e=0){return n.getPaginated(this.collection,t,e)}static async getByUser(t){return n.query(this.collection,[{field:"userId",op:"==",value:t}])}}class I{static collection="featureFlags";static async getAll(){return n.getAll(this.collection)}static async getById(t){return n.getById(this.collection,t)}static async create(t){return n.create(this.collection,t)}static async update(t,e){return n.update(this.collection,t,e)}static async delete(t){return n.delete(this.collection,t)}}class w{static collection="whiteLabelConfigs";static async getAll(){return(await n.getAll(this.collection)).map(t=>({...t,configId:t.id}))}static async getById(t){let e=await n.getById(this.collection,t);return e?{...e,configId:e.id}:null}static async getByTeamId(t){return(await n.query(this.collection,[{field:"teamId",op:"==",value:t}])).map(t=>({...t,configId:t.id}))}static async create(t){let e=await n.create(this.collection,t);return{...e,configId:e.id}}static async update(t,e){let a=await n.update(this.collection,t,e);return a?{...a,configId:a.id}:null}static async delete(t){return n.delete(this.collection,t)}}class f{static collection="referrals";static async getAll(){return(await n.getAll(this.collection)).map(t=>({...t,referralId:t.id}))}static async getById(t){let e=await n.getById(this.collection,t);return e?{...e,referralId:e.id}:null}static async getByReferrer(t){return(await n.query(this.collection,[{field:"referrerId",op:"==",value:t}])).map(t=>({...t,referralId:t.id}))}static async create(t){let e=await n.create(this.collection,t);return{...e,referralId:e.id}}static async update(t,e){let a=await n.update(this.collection,t,e);return a?{...a,referralId:a.id}:null}}class m{static collection="teamMembers";static async getAll(){return n.getAll(this.collection)}static async getByTeam(t){return n.query(this.collection,[{field:"teamId",op:"==",value:t}])}static async getById(t){return n.getById(this.collection,t)}static async create(t){return n.create(this.collection,t)}static async update(t,e){return n.update(this.collection,t,e)}static async delete(t){return n.delete(this.collection,t)}static async removeByUserAndTeam(t,e){let a=(0,i.getFirebaseDb)(),r=await a.collection(this.collection).where("teamId","==",t).where("userId","==",e).get();return!r.empty&&(await r.docs[0].ref.delete(),!0)}}class b{static collection="teamInvites";static async getAll(){return(await n.getAll(this.collection)).map(t=>({...t,inviteId:t.id}))}static async getByTeam(t){return(await n.query(this.collection,[{field:"teamId",op:"==",value:t}])).map(t=>({...t,inviteId:t.id}))}static async getByTeamId(t){return this.getByTeam(t)}static async getById(t){let e=await n.getById(this.collection,t);return e?{...e,inviteId:e.id}:null}static async create(t){let e=await n.create(this.collection,t);return{...e,inviteId:e.id}}static async update(t,e){return n.update(this.collection,t,e)}static async delete(t){return n.delete(this.collection,t)}}s.getAll,s.getById,s.create,s.update,s.delete,c.getAll,c.getById,c.create,c.update,c.delete,l.getAll,l.getById,l.create,l.update,l.delete,o.getAll,o.getById,o.create,o.update,d.getAll,d.getById,d.create,d.update,u.getAll,u.getById,u.create,w.getAll,w.getById,w.create,w.update,w.delete,f.getAll,f.getById,f.create,f.update,t.s(["AgentDatabase",()=>s,"AuditLogDatabase",()=>h,"ContractDatabase",()=>o,"FeatureFlagDatabase",()=>I,"PaymentMethodDatabase",()=>g,"PlanDatabase",()=>p,"ReferralDatabase",()=>f,"SubscriptionDatabase",()=>y,"TeamDatabase",()=>c,"TeamInviteDatabase",()=>b,"TeamMemberDatabase",()=>m,"TransactionDatabase",()=>u,"UserDatabase",()=>l,"WalletDatabase",()=>d,"WhiteLabelDatabase",()=>w]),a()}catch(t){a(t)}},!1),70534,t=>t.a(async(e,a)=>{try{var i=t.i(98003),r=t.i(59787),n=t.i(707),s=t.i(12224),c=e([i,n,s]);async function l(t,{params:e}){return(0,i.withAuth)(t,async t=>{try{let{contractId:a}=await e,i=await (0,r.safeParseJson)(t);if(!a)return(0,r.errorResponse)("Contract ID is required",400);if(!i.blockType||!i.quantity)return(0,r.errorResponse)("Missing required fields: blockType, quantity",400);let n=await s.ContractDatabase.getById(a);if(!n)return(0,r.errorResponse)("Contract not found",404);let c=n.blocks||n.metadata?.blocks||[],l=c.findIndex(t=>t.blockType===i.blockType);if(-1===l)return(0,r.errorResponse)("Block not found",404);c[l].quantity<=i.quantity?c=c.filter((t,e)=>e!==l):c[l].quantity-=i.quantity;let o={metadata:{...n.metadata,blocks:c},updatedAt:new Date().toISOString()},d=await s.ContractDatabase.update(a,o);return(0,r.successResponse)(d,"Block removed successfully")}catch(t){return console.error("POST /api/billing/contracts/[contractId]/remove-block Error:",t),(0,r.handleApiError)(t)}})}[i,n,s]=c.then?(await c)():c,(0,n.initializeFirebaseAdmin)(),t.s(["POST",()=>l]),a()}catch(t){a(t)}},!1),16310,t=>t.a(async(e,a)=>{try{var i=t.i(47909),r=t.i(74017),n=t.i(96250),s=t.i(59756),c=t.i(61916),l=t.i(14444),o=t.i(10680),d=t.i(69741),u=t.i(16795),p=t.i(87718),y=t.i(95169),g=t.i(47587),h=t.i(66012),I=t.i(70101),w=t.i(26937),f=t.i(10372),m=t.i(93695);t.i(52474);var b=t.i(220),v=t.i(70534),A=e([v]);[v]=A.then?(await A)():A;let B=new i.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/billing/contracts/[contractId]/remove-block/route",pathname:"/api/billing/contracts/[contractId]/remove-block",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/billing/contracts/[contractId]/remove-block/route.ts",nextConfigOutput:"",userland:v}),{workAsyncStorage:E,workUnitAsyncStorage:T,serverHooks:q}=B;function R(){return(0,n.patchFetch)({workAsyncStorage:E,workUnitAsyncStorage:T})}async function x(t,e,a){B.isDev&&(0,s.addRequestMeta)(t,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/billing/contracts/[contractId]/remove-block/route";i=i.replace(/\/index$/,"")||"/";let n=await B.prepare(t,e,{srcPage:i,multiZoneDraftMode:!1});if(!n)return e.statusCode=400,e.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:A,nextConfig:R,parsedUrl:x,isDraftMode:E,prerenderManifest:T,routerServerContext:q,isOnDemandRevalidate:D,revalidateOnlyGenerated:S,resolvedPathname:C,clientReferenceManifest:O,serverActionsManifest:P}=n,k=(0,d.normalizeAppPath)(i),N=!!(T.dynamicRoutes[k]||T.routes[C]),j=async()=>((null==q?void 0:q.render404)?await q.render404(t,e,x,!1):e.end("This page could not be found"),null);if(N&&!E){let t=!!T.routes[C],e=T.dynamicRoutes[k];if(e&&!1===e.fallback&&!t){if(R.experimental.adapterPath)return await j();throw new m.NoFallbackError}}let M=null;!N||B.isDev||E||(M=C,M="/index"===M?"/":M);let U=!0===B.isDev||!N,_=N&&!U;P&&O&&(0,l.setReferenceManifestsSingleton)({page:i,clientReferenceManifest:O,serverActionsManifest:P,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:P})});let H=t.method||"GET",F=(0,c.getTracer)(),L=F.getActiveScopeSpan(),$={params:A,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,s.getRequestMeta)(t,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:a.waitUntil,onClose:t=>{e.on("close",t)},onAfterTaskError:void 0,onInstrumentationRequestError:(e,a,i)=>B.onRequestError(t,e,i,q)},sharedContext:{buildId:v}},K=new u.NodeNextRequest(t),W=new u.NodeNextResponse(e),z=p.NextRequestAdapter.fromNodeNextRequest(K,(0,p.signalFromNodeResponse)(e));try{let n=async t=>B.handle(z,$).finally(()=>{if(!t)return;t.setAttributes({"http.status_code":e.statusCode,"next.rsc":!1});let a=F.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==y.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let e=`${H} ${r}`;t.setAttributes({"next.route":r,"http.route":r,"next.span_name":e}),t.updateName(e)}else t.updateName(`${H} ${i}`)}),l=!!(0,s.getRequestMeta)(t,"minimalMode"),o=async s=>{var c,o;let d=async({previousCacheEntry:r})=>{try{if(!l&&D&&S&&!r)return e.statusCode=404,e.setHeader("x-nextjs-cache","REVALIDATED"),e.end("This page could not be found"),null;let i=await n(s);t.fetchMetrics=$.renderOpts.fetchMetrics;let c=$.renderOpts.pendingWaitUntil;c&&a.waitUntil&&(a.waitUntil(c),c=void 0);let o=$.renderOpts.collectedTags;if(!N)return await (0,h.sendResponse)(K,W,i,$.renderOpts.pendingWaitUntil),null;{let t=await i.blob(),e=(0,I.toNodeOutgoingHttpHeaders)(i.headers);o&&(e[f.NEXT_CACHE_TAGS_HEADER]=o),!e["content-type"]&&t.type&&(e["content-type"]=t.type);let a=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,r=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await t.arrayBuffer()),headers:e},cacheControl:{revalidate:a,expire:r}}}}catch(e){throw(null==r?void 0:r.isStale)&&await B.onRequestError(t,e,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,g.getRevalidateReason)({isStaticGeneration:_,isOnDemandRevalidate:D})},q),e}},u=await B.handleResponse({req:t,nextConfig:R,cacheKey:M,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:D,revalidateOnlyGenerated:S,responseGenerator:d,waitUntil:a.waitUntil,isMinimalMode:l});if(!N)return null;if((null==u||null==(c=u.value)?void 0:c.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(o=u.value)?void 0:o.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||e.setHeader("x-nextjs-cache",D?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),E&&e.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,I.fromNodeOutgoingHttpHeaders)(u.value.headers);return l&&N||p.delete(f.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||e.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,w.getCacheControlHeader)(u.cacheControl)),await (0,h.sendResponse)(K,W,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};L?await o(L):await F.withPropagatedContext(t.headers,()=>F.trace(y.BaseServerSpan.handleRequest,{spanName:`${H} ${i}`,kind:c.SpanKind.SERVER,attributes:{"http.method":H,"http.target":t.url}},o))}catch(e){if(e instanceof m.NoFallbackError||await B.onRequestError(t,e,{routerKind:"App Router",routePath:k,routeType:"route",revalidateReason:(0,g.getRevalidateReason)({isStaticGeneration:_,isOnDemandRevalidate:D})}),N)throw e;return await (0,h.sendResponse)(K,W,new Response(null,{status:500})),null}}t.s(["handler",()=>x,"patchFetch",()=>R,"routeModule",()=>B,"serverHooks",()=>q,"workAsyncStorage",()=>E,"workUnitAsyncStorage",()=>T]),a()}catch(t){a(t)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__48f106ef._.js.map